<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#0b0b0c" />
  <title>Trio SMS Menu</title>

  <style>
    :root{
      --bg:#0b0b0c;
      --text:#f3f3f4;
      --muted:#b8b8bc;
      --border:rgba(255,255,255,.10);
      --accent:rgba(255,215,0,.95);
      --radius:16px;
    }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display",Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:linear-gradient(180deg,#070708,var(--bg));
      color:var(--text);
    }
    .wrap{max-width:980px;margin:0 auto;padding:18px 14px 60px}

    /* HEADER ELIMINAT COMPLET */
    header{display:none!important;}

    .search input{
      width:100%;
      padding:12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.05);
      color:var(--text);
      outline:none;
      font-size:15px;
      margin-bottom:12px;
    }
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .tab{
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      color:var(--muted);
      padding:9px 10px;border-radius:999px;
      font-size:13px;cursor:pointer;
    }
    .tab.active{
      color:var(--text);
      border-color:rgba(255,255,255,.22);
      background:rgba(255,255,255,.09);
    }
    .tab.fav.active{border-color:rgba(255,215,0,.35);background:rgba(255,215,0,.10)}
    .section{
      margin-top:16px;
      padding:14px;
      border:1px solid var(--border);
      border-radius:var(--radius);
      background:rgba(255,255,255,.03);
    }
    .section h2{margin:2px 0 12px;font-size:15px}
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
    @media (min-width:760px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
    .card{
      border:1px solid var(--border);
      background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
      border-radius:14px;
      padding:12px;
      cursor:pointer;
    }
    .row{display:flex;justify-content:space-between;gap:10px}
    .title{font-size:14px;font-weight:650}
    .pill{
      display:inline-flex;align-items:center;
      padding:6px 9px;font-size:12px;border-radius:999px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      margin-top:8px;
    }
    .star{font-size:18px;color:rgba(255,255,255,.65)}
    .star.on{color:var(--accent)}
    .hidden{display:none!important}
    .empty{color:var(--muted);font-size:13px}
  </style>
</head>

<body>
<div class="wrap">

  <input class="search" type="search" id="q" placeholder="Caută…" oninput="applyFilter()"/>

  <div class="tabs">
    <div class="tab active" data-tab="all" onclick="setTab('all')">Toate</div>
    <div class="tab fav" data-tab="fav" onclick="setTab('fav')">⭐ Favorite</div>
    <div class="tab" data-tab="temp" onclick="setTab('temp')">Temp Target</div>
    <div class="tab" data-tab="override" onclick="setTab('override')">Override</div>
    <div class="tab" data-tab="bolus" onclick="setTab('bolus')">Bolus</div>
    <div class="tab" data-tab="carbs" onclick="setTab('carbs')">Carbs</div>
  </div>

  <div class="section" data-section="fav">
    <h2>Favorite</h2>
    <div id="favGrid" class="grid"></div>
    <div id="favEmpty" class="empty hidden">Nu ai nimic în Favorite.</div>
  </div>

  <!-- EXEMPLU TEMP TARGET (restul rămâne identic cu ce aveai) -->
  <div class="section" data-section="temp">
    <h2>Temp Target</h2>
    <div class="grid">
      <div class="card" data-section="temp" data-code="TTC" data-label="Temp Target Cancel" onclick="sendSMS('TTC')">
        <div class="row">
          <div class="title">Temp Target Cancel</div>
          <div class="star" onclick="toggleFav(event,'TTC','Temp Target Cancel','temp')">☆</div>
        </div>
        <span class="pill">TTC</span>
      </div>
    </div>
  </div>

</div>

<script>
  /* DESTINATARI – separator ; (FIX CRITIC) */
  const PHONE = "0745923843;0757765345;0754628256";

  const FAV_KEY="trio_sms_favs_v1";
  let currentTab="all";
  let favs=JSON.parse(localStorage.getItem(FAV_KEY)||"{}");

  function sendSMS(code){
    const body=encodeURIComponent(code);
    window.location.href=`sms:${PHONE}&body=${body}`;
  }

  function toggleFav(e,code,label,section){
    e.stopPropagation();
    if(favs[code]) delete favs[code];
    else favs[code]={code,label,section};
    localStorage.setItem(FAV_KEY,JSON.stringify(favs));
    renderFavs();syncStars();
  }

  function renderFavs(){
    const g=document.getElementById("favGrid");
    const e=document.getElementById("favEmpty");
    g.innerHTML="";
    const a=Object.values(favs);
    if(!a.length){e.classList.remove("hidden");return}
    e.classList.add("hidden");
    a.forEach(it=>{
      const d=document.createElement("div");
      d.className="card";
      d.dataset.section="fav";
      d.dataset.code=it.code;
      d.dataset.label=it.label;
      d.onclick=()=>sendSMS(it.code);
      d.innerHTML=`<div class="row"><div class="title">${it.label}</div><div class="star on">★</div></div><span class="pill">${it.code}</span>`;
      g.appendChild(d);
    });
  }

  function syncStars(){
    document.querySelectorAll(".card .star").forEach(s=>{
      const c=s.closest(".card")?.dataset.code;
      if(!c) return;
      s.classList.toggle("on",!!favs[c]);
      s.textContent=favs[c]?"★":"☆";
    });
  }

  function setTab(t){
    currentTab=t;
    document.querySelectorAll(".tab").forEach(x=>x.classList.toggle("active",x.dataset.tab===t));
    applyFilter();
  }

  function applyFilter(){
    const q=(document.getElementById("q").value||"").toLowerCase();
    document.querySelectorAll(".section").forEach(sec=>{
      const ok=currentTab==="all"||sec.dataset.section===currentTab;
      sec.classList.toggle("hidden",!ok);
    });
    document.querySelectorAll(".card").forEach(c=>{
      const ok=(currentTab==="all"||c.dataset.section===currentTab);
      const txt=(c.dataset.code+" "+c.dataset.label).toLowerCase();
      c.classList.toggle("hidden",!(ok&&(!q||txt.includes(q))));
    });
  }

  renderFavs();syncStars();applyFilter();
</script>
</body>
</html>
